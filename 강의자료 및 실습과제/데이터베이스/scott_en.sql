drop table emp;
drop table dept;
drop table bonus;
drop table salgrade;


CREATE TABLE EMP
(EMPNO number not null,
ENAME VARCHAR2(10),
JOB VARCHAR2(9),
MGR number,
HIREDATE date,
SAL number,
COMM number,
DEPTNO number);

INSERT INTO EMP VALUES
(7369,'SMITH','CLERK',7902,'1980-12-17',800,null,20);
INSERT INTO EMP VALUES
(7499,'ALLEN','SALESMAN',7698,'1981-02-20',1600,300,30);
INSERT INTO EMP VALUES
(7521,'WARD','SALESMAN',7698,'1981-02-22',1250,200,30);
INSERT INTO EMP VALUES
(7566,'JONES','MANAGER',7839,'1981-04-02',2975,30,20);
INSERT INTO EMP VALUES
(7654,'MARTIN','SALESMAN',7698,'1981-09-28',1250,300,30);
INSERT INTO EMP VALUES
(7698,'BLAKE','MANAGER',7839,'1981-04-01',2850,null,30);
INSERT INTO EMP VALUES
(7782,'CLARK','MANAGER',7839,'1981-06-01',2450,null,10);
INSERT INTO EMP VALUES
(7788,'SCOTT','ANALYST',7566,'1982-10-09',3000,null,20);
INSERT INTO EMP VALUES
(7839,'KING','PRESIDENT',null,'1981-11-17',5000,3500,10);
INSERT INTO EMP VALUES
(7844,'TURNER','SALESMAN',7698,'1981-09-08',1500,0,30);
INSERT INTO EMP VALUES
(7876,'ADAMS','CLERK',7788,'1983-01-12',1100,null,20);
INSERT INTO EMP VALUES
(7900,'JAMES','CLERK',7698,'1981-10-03',950,null,30);
INSERT INTO EMP VALUES
(7902,'FORD','ANALYST',7566,'1981-10-3',3000,null,20);
INSERT INTO EMP VALUES
(7934,'MILLER','CLERK',7782,'1982-01-23',1300,null,10);

CREATE TABLE DEPT
(DEPTNO number,
DNAME VARCHAR2(14),
LOC VARCHAR2(13) );

INSERT INTO DEPT VALUES (10,'ACCOUNTING','NEW YORK');
INSERT INTO DEPT VALUES (20,'RESEARCH','DALLAS');
INSERT INTO DEPT VALUES (30,'SALES','CHICAGO');
INSERT INTO DEPT VALUES (40,'OPERATIONS','BOSTON');

CREATE TABLE BONUS
(
ENAME VARCHAR2(10),
JOB VARCHAR2(9),
SAL number,
COMM number
);


CREATE TABLE SALGRADE
( GRADE number,
LOSAL number,
HISAL number);

INSERT INTO SALGRADE VALUES (1,700,1200);
INSERT INTO SALGRADE VALUES (2,1201,1400);
INSERT INTO SALGRADE VALUES (3,1401,2000);
INSERT INTO SALGRADE VALUES (4,2001,3000);
INSERT INTO SALGRADE VALUES (5,3001,9999);

commit;

SELECT * FROM EMP;

--1번
SELECT * 
FROM EMP
WHERE COMM IS NOT NULL;

--2번
SELECT *
FROM EMP
WHERE COMM IS NULL  OR COMM = 0;

--3번
SELECT *
FROM EMP
WHERE JOB <> 'MANAGER';

--4번
SELECT *
FROM EMP
ORDER BY MGR DESC;

--5번
SELECT *
FROM EMP
ORDER BY MGR, COMM DESC;

--6번
SELECT EMPNO, ENAME, JOB, HIREDATE
FROM EMP
ORDER BY HIREDATE;

--7번
SELECT EMPNO,ENAME
FROM EMP
ORDER BY EMPNO DESC;

--8번
SELECT EMPNO, HIREDATE, ENAME, MGR
FROM EMP
ORDER BY EMPNO ASC, HIREDATE DESC;

--함수 1번
SELECT SYSDATE FROM DUAL;

--2번
SELECT EMPNO, ENAME, TRUNC(MGR, -2)
FROM EMP
ORDER BY MGR DESC;

--3번
SELECT *
FROM EMP
WHERE MOD(EMPNO,2) =1;

--문자 처리 1번
SELECT ENAME, CONCAT(CONCAT(SUBSTR(HIREDATE,1,2),'년 '),CONCAT(SUBSTR(HIREDATE,4,2),'월') ) "입사년도"
FROM EMP;

--2번
SELECT *
FROM EMP
WHERE SUBSTR(HIREDATE,4,2) = '09';

--3번
SELECT *
FROM EMP
WHERE SUBSTR(HIREDATE,1,2) = '81';

--4번
SELECT *
FROM EMP
WHERE SUBSTR(ENAME, LENGTH(ENAME),1 ) = 'E'; 

--5번
SELECT *
FROM EMP
WHERE ENAME LIKE '__R%';

--6번
SELECT *
FROM EMP
WHERE SUBSTR(ENAME, 3,1 ) = 'R'; 

--날짜 처리 1번
SELECT ADD_MONTHS(HIREDATE,480) "입사 40년 뒤" , ENAME
FROM EMP;

--2번
SELECT *
FROM EMP
WHERE MONTHS_BETWEEN(SYSDATE,HIREDATE) >=  396;

--3번
SELECT EXTRACT(YEAR FROM SYSDATE) "년도"
FROM DUAL;

